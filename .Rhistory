which(duplicated(swiss))
sw.2 <- Rtsne(swiss,dim =2 , perplexity = 15 )#2차원 산점도
sw.3 <- Rtsne(swiss,dim =3 , perplexity = 15 )#3차원 산점도
df.2 <- data.frame(sw.2$Y)
df.2
ggplot(df.2,aes(x=X1,y=X2))+
geom_point(size = 3)
library(Rtsne)
library(car)
library(rgl)
library(mgcv)
library(tidyverse)
df.2 <- data.frame(sw.2$Y)
df.2
ggplot(df.2,aes(x=X1,y=X2))+
geom_point(size = 3)
sw.2 <- Rtsne(swiss,dim =2 , perplexity = 15 )#2차원 산점도
sw.3 <- Rtsne(swiss,dim =3 , perplexity = 15 )#3차원 산점도
df.2 <- data.frame(sw.2$Y)
df.2
ggplot(df.2,aes(x=X1,y=X2))+
geom_point(size = 3)
df.3
df.3 <- data.frame(sw.3$Y)
df.3
scatter3d(x = df.3$X1, y = df.3$X2, z = df.3$X3)
#문3)
#R을 이용하여 지도를 출력하시오.
library(ggmap)
register_google(key = "AIzaSyBW1-gQiLvNeJ3_pTZnF_rhU3sxbIPHC9c")
#(1) 서울시청을 중심으로 지도 크기는 600x600, 지도 유형은 roadmap인 지도를 출력
#하시오.
cityhall <- geocode(enc2utf8("서울시청"))
cityhall
ch <- as.numeric(cityhall)
ch
ch.map <- get_googlemap(center = ch,
zoom = 8,
size = c(600,600),
maptype = "roadmap")
ggmap(ch.map)
ch.map <- get_googlemap(center = ch,
zoom = 15,
size = c(600,600),
maptype = "roadmap")
ggmap(ch.map)
ch.map <- get_googlemap(center = ch,
zoom = 20,
size = c(600,600),
maptype = "roadmap")
ggmap(ch.map)
ch.map <- get_googlemap(center = ch,
zoom = 15,
size = c(600,600),
maptype = "roadmap")
ggmap(ch.map)
ch.map <- get_googlemap(center = ch,
zoom = 18,
size = c(600,600),
maptype = "roadmap")
ggmap(ch.map)
ch.map <- get_googlemap(center = ch,
zoom = 16,
size = c(600,600),
maptype = "roadmap")
ggmap(ch.map)
#(2) 금강산 지역을 근방으로 지도 크기는 500x500, 지도 유형은 hybrid, zoom은 8
#인 지도를 출력하시오.
km <- geocode(enc2utf8("금강산"))
km
#(2) 금강산 지역을 근방으로 지도 크기는 500x500, 지도 유형은 hybrid, zoom은 8
#인 지도를 출력하시오.
kkmt <- geocode(enc2utf8("금강산"))
kkmt
km <- as.numeric(kkmt)
km
km.map <- get_googlemap(center = km ,
zoom = 8,
size = c(500,500),
maptype = "hybrid")
ggmap(km.map)
#(3) 강남역 근방으로 지도 크기는 640x640, 지도 유형은 roadmap, zoom은 16인 지
#도를 출력하시오.
gnst <- geocode(enc2utf8("강남역"))
gs <- as.numeric(gnst)
gs
gs.map <- get_googlemap(center = gs,
zoom = 16,
size = c(640,640),
maptype = "roadmap")
ggmap(gs.map)
map <- get_googlemap(center = c(127.397692,36.337058),
zoom = 9 ,
size = c(640,640),
maptype = "roadmap")
ggmap(map)
map <-  get-googlemap( center = c(135.502330,34.693594),
zoom = 10 ,
maptype = "roadmap")
ggmap(map)
map <-  get-googlemap( center = c(135.502330,34.693594),
zoom = 10 ,
maptype = "roadmap")
ggmap(map)
map <-  get_googlemap( center = c(135.502330,34.693594),
zoom = 10 ,
maptype = "roadmap")
ggmap(map)
map.5 <-  get_googlemap( center = c(135.502330,34.693594),
zoom = 10 ,
maptype = "roadmap")
ggmap(map.5)
map.4 <- get_googlemap(center = c(127.397692,36.337058),
zoom = 9 ,
size = c(640,640),
maptype = "roadmap")
ggmap(map.4)
names <- c("강서구청","양천구청","구로구청","영등포구청","동작구청","관악구청",
"서초구청","강남구청","송파구청","강동구청")
gc <- geocode(enc2utf8(add))
add <- c("서울특별시 강서구 화곡6동 화곡로 302",
"서울특별시 양천구 신정동 목동동로 105",
"서울특별시 구로구 구로동 가마산로 245",
"서울특별시 영등포구 당산동3가 당산로 123",
"서울특별시 동작구 노량진2동 장승배기로 161",
"서울특별시 관악구 관악로 145",
"서울특별시 서초구 서초2동 남부순환로 2584",
"서울특별시 강남구 삼성2동 학동로 426",
"서울특별시 송파구 잠실6동 올림픽로 326",
"서울특별시 강동구 성내동 성내로 25",
"서울특별시 시흥1동")
gc <- geocode(enc2utf8(add))
gc
df <- data.frame(name = names , lon = gc$lon , lat = gc$lat)
df
df <- data.frame(name = names , lon = gc$lon , lat = gc$lat)
names <- c("강서구청","양천구청","구로구청","영등포구청","동작구청","관악구청",
"서초구청","강남구청","송파구청","강동구청","금천구청")
add <- c("서울특별시 강서구 화곡6동 화곡로 302",
"서울특별시 양천구 신정동 목동동로 105",
"서울특별시 구로구 구로동 가마산로 245",
"서울특별시 영등포구 당산동3가 당산로 123",
"서울특별시 동작구 노량진2동 장승배기로 161",
"서울특별시 관악구 관악로 145",
"서울특별시 서초구 서초2동 남부순환로 2584",
"서울특별시 강남구 삼성2동 학동로 426",
"서울특별시 송파구 잠실6동 올림픽로 326",
"서울특별시 강동구 성내동 성내로 25",
"서울특별시 시흥1동")
gc <- geocode(enc2utf8(add))
gc
df <- data.frame(name = names , lon = gc$lon , lat = gc$lat)
df
cen <- c(mean(df$lon),mean(df$lat))
map <- get_googlemap(center = cen,
maptype = 'roadmap',
zoom = 16,
size = c(640,640),
marker = gc)
ggmap(map)
map <- get_googlemap(center = cen,
maptype = 'roadmap',
zoom = 7,
size = c(640,640),
marker = gc)
ggmap(map)
map <- get_googlemap(center = cen,
maptype = 'roadmap',
zoom = 13,
size = c(640,640),
marker = gc)
ggmap(map)
map <- get_googlemap(center = cen,
maptype = 'roadmap',
zoom = 10,
size = c(640,640),
marker = gc)
ggmap(map)
ggmap(map)
map <- get_googlemap(center = cen,
maptype = 'roadmap',
zoom = 11,
size = c(640,640),
marker = gc)
ggmap(map)
gc <- geocode(enc2utf8(c(names))
gc
names <- c("부산광역시",'대구광역시','인천광역시','광주광역시',
'대전광역시','울산광역시')
gc <- geocode(enc2utf8(names))
gc
cen <- c(mean(gc$lon),mean(gc$lat))
map <- get_googlemap(center = cen ,
maptype = "roadmap",
zoom = 5,
marker = gc)
ggmap(map)
map <- get_googlemap(center = cen ,
maptype = "roadmap",
zoom = 7,
marker = gc)
ggmap(map)
map <- get_googlemap(center = cen ,
maptype = "roadmap",
zoom = 7.5,
marker = gc)
ggmap(map)
map <- get_googlemap(center = cen ,
maptype = "roadmap",
zoom = 8,
marker = gc)
ggmap(map)
map <- get_googlemap(center = cen ,
maptype = "roadmap",
zoom = 7,
marker = gc)
ggmap(map)
ggmap(map)
df
gmap +
geom_text(data = df,
aes(x=lon, y =lat),
size=5,
label= df$name)
gc <- geocode(enc2utf8(add))
gc
df <- data.frame(name = names , lon = gc$lon , lat = gc$lat)
df
cen <- c(mean(df$lon),mean(df$lat))
map <- get_googlemap(center = cen,
maptype = 'roadmap',
zoom = 11,
size = c(640,640),
marker = gc)
gmap <- ggmap(map)
gmap +
geom_text(data = df,
aes(x=lon, y =lat),
size=5,
label= df$name)
gmap +
geom_text(data = df,
aes(x=lon, y =lat),
size=4,
label= df$name)
gmap.4 <- ggmap(map)
gmap.4 +
geom_text(data = df,
aes(x=lon, y =lat),
size=4,
label= df$name)
df.5 <- data.frame(names,gc)
cen <- c(mean(gc$lon),mean(gc$lat))
df.5
df.5 <- data.frame(names,gc)
df.5
df.5 <- data.frame(name = names,lon =gc$lon, lat = gc$lat)
df.5
gc <- geocode(enc2utf8(names))
gc
df.5 <- data.frame(name = names,lon =gc$lon, lat = gc$lat)
df.5
gmap.5 +
geom_text(data = df.5,
aes(x = lon , y = lat),
size =6 ,
label = df$name)
gmap.5 <- ggmap(map)
gmap.5 +
geom_text(data = df.5,
aes(x = lon , y = lat),
size =6 ,
label = df$name)
gc
gmap.5
gmap.5 +
geom_text(data = df.5,
aes(x = lon , y = lat),
size =6 ,
label = df$name)
df.5
gc
gmap.5 +
geom_text(data = df.5,
aes(x = df$lon , y = df$lat),
size =6 ,
label = df$name)
gmap.5 +
geom_text(data = df.5,
aes(x = df$lon , y = df$lat),
size =6 ,
label = df.5$name)
gmap.5 <- ggmap(map)
gmap.5 +
geom_text(data = df.5,
aes(x = df$lon , y = df$lat),
size =6 ,
label = df.5$name)
df.5
gmap.5 +
geom_text(data = df.5,
aes(x = df$lon , y = df$lat),
size =6 ,
label = name)
gc <- geocode(enc2utf8(names))
gc
df.5
map <- get_googlemap(center = cen ,
maptype = "roadmap",
zoom = 6,
marker = gc)
gmap.5 <- ggmap(map)
gmap.5 +
geom_text(data = df.5,
aes(x = df$lon , y = df$lat),
size =6 ,
label = name)
gmap.5 +
geom_text(data = df.5,
aes(x = df$lon , y = df$lat),
size =6 ,
label = df.5$name)
gc <- geocode(enc2utf8(c("부산광역시",'대구광역시','인천광역시','광주광역시',
'대전광역시','울산광역시')))
gc
df.5 <- data.frame(name = names,lon =gc$lon, lat = gc$lat)
df.5
cen <- c(mean(gc$lon),mean(gc$lat))
map <- get_googlemap(center = cen ,
maptype = "roadmap",
zoom = 6,
marker = gc)
gmap.5 <- ggmap(map)
gmap.5 +
geom_text(data = df.5,
aes(x = df$lon , y = df$lat),
size =6 ,
label = df.5$name)
gmap.5
gmap.5 +
geom_text(data = df.5,
aes(x = df.5$lon , y = df.5$lat),
size =6 ,
label = df.5$name)
gmap.5 +
geom_text(data = df.5,
aes(x = df.5$lon , y = df.5$lat),
size =4 ,
label = df.5$name)
names <- c("북한산","설악산","오대산","치악산")
names <- c("북한산국립공원","설악산국립공원","오대산국립공원","치악산국립공원")
gc <- geocode(enc2utf8(names))
gc
df
df <- data.frame(name = names , lon = gc$lon , lat = gc$lat)
df
cen <- c(mean(df$lon),mean(df$lat))
cen
map <- get_googlemap(center = cen ,
maptype = "roadmap",
zoom = 6,
marker =gc)
ggmap(map)
map <- get_googlemap(center = cen ,
maptype = "roadmap",
zoom = 8,
marker =gc)
ggmap(map)
map <- get_googlemap(center = cen ,
maptype = "roadmap",
zoom = 9,
marker =gc)
ggmap(map)
map <- get_googlemap(center = cen ,
maptype = "roadmap",
zoom = 8,
size = c(800,800)
marker =gc)
ggmap(map)
map <- get_googlemap(center = cen ,
maptype = "roadmap",
zoom = 7,
size = c(800,800),
marker =gc)
ggmap(map)
map <- get_googlemap(center = cen ,
maptype = "roadmap",
zoom = 7,
size = c(800,800),
marker =gc)
ggmap(map)
gmap <- ggmap(map)
label = name)
label = df$name)
gmap +
geom_text(data = df,
aes(x= gc$lon, y = gc$lat),
size =5,
label = df$name)
gmap +
geom_text(data = df,
aes(x= gc$lon, y = gc$lat),
size =4,
label = df$name)
read.csv(file = "도로교통공단_전국_사망교통사고정보(2018)_20190910.csv")
library(xlsx)
read.csv(file = "도로교통공단_전국_사망교통사고정보(2018)_20190910.csv")
getwd()
setwd("C:/learnR")
getwd()
car.acc <- read.csv(file ="제주교통사고발생현황 (20181231).csv")
acc <- read.csv(file ="도로교통공단_전국_사망교통사고정보(2018)_20190910.csv")
head(car.acc)
a
head(acc)
class(acc)
View(acc)
acc.s
acc.s <- data.frame(1:nrow(acc) ,acc$발생지시군구)
acc.s
acc.s <- data.frameacc$발생지시군구)
acc.s <- data.frame(acc$발생지시군구)
acc.s
acc.s <- data.frame(acc$발생지시도,acc$발생지시군구)
acc.s
acc.s <- data.frame(acc$발생지시도,acc$발생지시군구)
acc.s
table(acc.s)
acc.s
head(acc.s)
acc.s <- data.frame(발생지시도,발생지시군구)
head(acc.s)
acc.s <- data.frame(발생지시도,발생지시군구)
acc.s <- data.frame(acc$발생지시도,acc$발생지시군구)
head(acc.s)
ac.s <- acc.s[acc.발생지시도 ="서울", ]
ac.s
head(acc.s)
ac.s <- subset(acc.s , acc.s == "서울")
ac.s
table(ac.s)
ac.s
ac.s
gc
gc <- geocode(enc2utf8(acc$발생지시군구))
gc <- geocode(acc$발생지시군구)
gc
ac.s <- subset(acc.s , acc.s == "서울")
ac.s
class(ac.s)
acc.s <- data.frame(acc$발생지시군구)
head(acc.s)
ac.s <- subset(acc.s , acc.s == "서울")
ac.s
ac.s
acc.s <- data.frame(acc$발생지시도,acc$발생지시군구)
head(acc.s)
ac.s <- subset(acc.s , acc.s == "서울")
ac.s
gc <- geocode(acc$발생지시군구)
class(ac.s)
class(ac.s)
ac.s
area <- c(ac.s$acc.발생지시군구)
area
area <- c(ac.s$acc.발생지시군구)
area <- ac.s[ ,2]
area
names <- c(area)
names
class(area)
table(area)
gc <- geocode(enc2utf8(area))
gc <- geocode(enc2utf8(c(area))
gc <- geocode(enc2utf8(c(area)))
gc
area
gc
gc <- geocode(enc2utf8(area))
ar <- as.character(area)
gc <- geocode(enc2utf8(area))
ar <- as.character(area)
gc <- geocode(enc2utf8(ar))
ar.sa <- sample(1:nrow(ar),100)
dim(ar)
str(ar)
dim(ar)
ar1 <- sample(ar,100)
ar1
gc <- geocode(enc2utf8(ar1))
gc
df1
df1 <- data.frame(name = names, lon = gc$lon, lat = gc$lat)
df1
df1 <- data.frame( lon = gc$lon, lat = gc$lat)
df1
cen <-  c(mean(df1$lon),mean(df1$lat))
map <- get_googlemap(center = cen,maptype = "roadmap",zoom = 6)
gmap <- ggmap(map)
table(ar1)
aes(x = lon, y = lat, size = ar1 )
gmap <- ggmap(map)
gmap +
geom_point(data =df1,
aes(x = lon, y = lat, size = ar1 ),
alpha = 0.4, col = "blue") +
scale_size_continuous(range = c(1,25))
gmap +
geom_point(data =df1,
aes(x = lon, y = lat, size = ar1 ),
alpha = 0.4, col = "blue") +
scale_size_continuous(range = c(1,10))
